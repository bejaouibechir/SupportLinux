# Creation d'un  service simple

montre comment utiliser `systemd` Ã  la fois pour le lancement et la surveillance d'applications.

Voici un **exemple complet, minimal et fonctionnel** dâ€™une application Flask gÃ©rÃ©e par `systemd`, avec tous les fichiers bien configurÃ©s.

---

### ğŸ§± 1. Arborescence proposÃ©e :

```
/opt/myapp/
â”œâ”€â”€ app.py
â””â”€â”€ run.sh
```

---

### ğŸ“„ `app.py` â€“ Application Flask

CrÃ©e ce fichier :

```bash
sudo mkdir -p /opt/myapp
sudo nano /opt/myapp/app.py
```

Contenu :

```python
from flask import Flask

app = Flask(__name__)

@app.route('/')
def home():
    return "Hello, this is myapp!"

if __name__ == "__main__":
    app.run(host="0.0.0.0", port=5000)
```

---

### ğŸ”§ `run.sh` â€“ Script de lancement

CrÃ©e :

```bash
sudo nano /opt/myapp/run.sh
```

Contenu :

```bash
#!/bin/bash
cd /opt/myapp
exec python3 app.py
```

Rends-le exÃ©cutable :

```bash
sudo chmod +x /opt/myapp/run.sh
```

---

### ğŸ‘¤ Droits

Attribue tout Ã  lâ€™utilisateur `jenkins` :

```bash
sudo chown -R jenkins:jenkins /opt/myapp
```

---

### âš™ï¸ `/etc/systemd/system/myapp.service`

CrÃ©e le fichier systemd :

```bash
sudo nano /etc/systemd/system/myapp.service
```

Contenu :

```ini
[Unit]
Description=Flask Web Application - myapp
After=network.target

[Service]
User=jenkins
WorkingDirectory=/opt/myapp
ExecStart=/opt/myapp/run.sh
Restart=always
RestartSec=5
Environment=FLASK_ENV=production

[Install]
WantedBy=multi-user.target
```

---

### ğŸš€ RedÃ©marrer et activer le service :

```bash
sudo systemctl daemon-reload
sudo systemctl enable myapp.service
sudo systemctl start myapp.service
sudo systemctl status myapp.service
```

---

### âœ… Test

Ouvre un navigateur ou utilise `curl` :

```bash
curl http://localhost:5000
```

Le resultat attendu :

```
Hello, this is myapp!
```

