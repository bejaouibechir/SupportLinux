# Démos bashrc

## bashrc vs profile 

`~/.bashrc` configure ton environnement **à chaque shell interactif** (alias, fonctions, variables…), tandis que `~/.profile` s’exécute **au login** (démarrage de session) pour définir l’environnement global de l’utilisateur.


* **`~/.bashrc`** (Bash Run Commands) est lu à **chaque shell interactif non-login**.
* Sous Ubuntu, même en login SSH, `~/.profile` **source** `~/.bashrc`, donc tes réglages s’appliquent quasi partout.
* On s’en sert pour : **alias**, **fonctions**, **variables d’environnement**, **personnalisation** (prompt, options Bash, PATH, etc.).

---

> Astuce : chaque démo ajoute un bloc marqué dans `~/.bashrc`.
>
> * **Activer** : colle le bloc, puis `source ~/.bashrc`.
> * **Tester** : commandes indiquées sous chaque démo.
> * **Nettoyer** : utilise le bloc “Nettoyage” à la fin.

---

## 1) Les alias — 2 démos

### Démo A — Alias `ll` lisible

```bash
cat >> ~/.bashrc <<'EOF'
# ==== DEMO_ALIAS_LL_START ====
alias ll='ls -lah --group-directories-first --time-style=+"%Y-%m-%d %H:%M"'
# ==== DEMO_ALIAS_LL_END ====
EOF
source ~/.bashrc
# test
ll
```

### Démo B — Alias d’analyse rapide des 5 processus les plus gourmands

```bash
cat >> ~/.bashrc <<'EOF'
# ==== DEMO_ALIAS_TOP5_START ====
alias top5='ps aux --sort=-%mem | head -n 5'
# ==== DEMO_ALIAS_TOP5_END ====
EOF
source ~/.bashrc
# test
top5
```

---

## 2) Les fonctions — 2 démos

### Démo A — `mkcd`: créer un dossier puis s’y déplacer

```bash
cat >> ~/.bashrc <<'EOF'
# ==== DEMO_FUNC_MKCD_START ====
mkcd () {
  [ -z "$1" ] && { echo "Usage: mkcd <dir>"; return 1; }
  mkdir -p -- "$1" && cd -- "$1" || return
}
# ==== DEMO_FUNC_MKCD_END ====
EOF
source ~/.bashrc
# test
mkcd /tmp/demo-mkcd && pwd
```

### Démo B — `extract`: extraire selon l’extension (.tar.gz, .zip, …)

```bash
cat >> ~/.bashrc <<'EOF'
# ==== DEMO_FUNC_EXTRACT_START ====
extract () {
  [ -f "$1" ] || { echo "Fichier introuvable: $1"; return 1; }
  case "$1" in
    *.tar.gz|*.tgz)   tar -xzf "$1"   ;;
    *.tar.bz2|*.tbz2) tar -xjf "$1"   ;;
    *.tar.xz|*.txz)   tar -xJf "$1"   ;;
    *.zip)            unzip -q "$1"   ;;
    *) echo "Type non géré: $1"; return 2 ;;
  esac
}
# ==== DEMO_FUNC_EXTRACT_END ====
EOF
source ~/.bashrc
# test rapide (ex: crée un zip puis extrait)
cd /tmp && echo hello > a.txt && zip -q demo.zip a.txt && rm a.txt && extract demo.zip && ls -l
```

---

## 3) Variables d’environnement — 2 démos

### Démo A — Définir une variable `APP_ENV` persistante

```bash
cat >> ~/.bashrc <<'EOF'
# ==== DEMO_ENV_APPENV_START ====
export APP_ENV="production"
# ==== DEMO_ENV_APPENV_END ====
EOF
source ~/.bashrc
# test
echo "APP_ENV=$APP_ENV"
```

### Démo B — Ajouter `~/bin` au PATH et exécuter un script perso

```bash
cat >> ~/.bashrc <<'EOF'
# ==== DEMO_ENV_PATH_START ====
# Ajoute ~/bin en tête du PATH si présent
if [ -d "$HOME/bin" ] && [[ ":$PATH:" != *":$HOME/bin:"* ]]; then
  export PATH="$HOME/bin:$PATH"
fi
# ==== DEMO_ENV_PATH_END ====
EOF
mkdir -p ~/bin
cat > ~/bin/hello <<'SH'
#!/usr/bin/env bash
echo "Hello from ~/bin on $(hostname)"
SH
chmod +x ~/bin/hello
source ~/.bashrc
# test
which hello && hello
```

---

## 4) Personnalisation d’environnement — 2 démos

### Démo A — Prompt PS1 informatif (heure, user\@hôte, dossier, code retour)

```bash
cat >> ~/.bashrc <<'EOF'
# ==== DEMO_PERSONA_PS1_START ====
# Couleurs
RED="\[\e[31m\]"; GREEN="\[\e[32m\]"; BLUE="\[\e[34m\]"; YELLOW="\[\e[33m\]"
RESET="\[\e[0m\]"
# Affiche le code retour précédent si non nul
ret_code_segment='$(ret=$?; [ $ret -ne 0 ] && echo "'"$RED"'[exit:$ret]'"$RESET"' ")'
# PS1: [HH:MM] user@host:cwd (APP_ENV) $
export PS1="[\A] ${BLUE}\u@\h${RESET}:${YELLOW}\w${RESET} (\$APP_ENV) \$ret_code_segment\$ "
# ==== DEMO_PERSONA_PS1_END ====
EOF
source ~/.bashrc
# test: force une erreur pour voir [exit:...]
false ; echo "Si rouge [exit:1] apparaît dans le prompt, c'est OK."
```

### Démo B — Options Bash utiles (auto-cd, casse insensible, historique propre)

```bash
cat >> ~/.bashrc <<'EOF'
# ==== DEMO_PERSONA_SHOPT_HIST_START ====
# Aller dans un dossier en tapant juste son nom (auto_cd)
shopt -s autocd
# Globbing insensible à la casse (ls *.TXT matche *.txt)
shopt -s nocaseglob
# Historique: pas de doublons, fusionne les occurrences, taille étendue
export HISTCONTROL=ignoredups:erasedups
export HISTSIZE=50000
export HISTFILESIZE=100000
# ==== DEMO_PERSONA_SHOPT_HIST_END ====
EOF
source ~/.bashrc
# test:
mkdir -p /tmp/DemoCase && cd /tmp/democase && pwd   # autocd + nocaseglob
history | tail -n 5
```

---

## Nettoyage (optionnel)

Supprime tous les blocs ajoutés par ces démos :

```bash
# Sauvegarde préalable
cp ~/.bashrc ~/.bashrc.bak.$(date +%F_%H%M)
# Suppression par marqueurs
sed -i -e '/^# ==== DEMO_.*_START ====/,/^# ==== DEMO_.*_END ====/d' ~/.bashrc
# Recharger
source ~/.bashrc
echo "Nettoyage terminé. Copie de sauvegarde: ~/.bashrc.bak.*"
```


# Execices sur utilisation de ~/.bashrc
---
### **Exercice 1 – Alias pour `ls -la`**
**Problème :** Tu tapes toujours `ls -la` pour voir les fichiers.  
**Objectif :** Créer un alias simple.

✅ **Solution** (dans `~/.bashrc`) :
```bash
alias ll='ls -la'
```

💡 **Utilisation** :
```bash
ll
```

---

### **Exercice 2 – Naviguer vite dans un dossier**
**Problème :** Tu vas souvent dans `/var/www/html`.  
**Objectif :** Créer un alias.

✅ **Solution** :
```bash
alias web='cd /var/www/html'
```

💡 **Utilisation** :
```bash
web
```

---

### **Exercice 3 – Corriger une faute de frappe**
**Problème :** Tu tapes souvent `sl` au lieu de `ls`.  
**Objectif :** Rediriger la faute.

✅ **Solution** :
```bash
alias sl='ls'
```

💡 **Utilisation** :
```bash
sl
```

---

### **Exercice 4 – Ajouter une option par défaut à une commande**
**Problème :** Tu veux que `grep` ait toujours les couleurs.  
**Objectif :** Modifier le comportement par défaut.

✅ **Solution** :
```bash
alias grep='grep --color=auto'
```

💡 **Utilisation** :
```bash
grep "mot" fichier.txt
```

---

### **Exercice 5 – Tester un alias temporaire**
**Problème :** Tu veux tester une commande sans l'enregistrer.  
**Objectif :** Créer un alias pour la session actuelle.

✅ **Solution** (directement dans le terminal) :
```bash
alias bonjour='echo Salut !'
```

💡 **Utilisation** :
```bash
bonjour
```

---

## 🔸 Niveau 2 – Fonctions de base (Ex. 6 à 10)

---

### **Exercice 6 – Sauvegarder un dossier**
**Problème :** Tu veux sauvegarder ton dossier de travail.  
**Objectif :** Créer une fonction avec nom de sauvegarde.

✅ **Solution** :
```bash
sauvegarder() {
    cp -r ~/travail ~/sauvegardes/$(date +%F)
}
```

💡 **Utilisation** :
```bash
sauvegarder
```

---

### **Exercice 7 – Ouvrir plusieurs fichiers en une commande**
**Problème :** Tu veux éditer plusieurs fichiers de config ensemble.  
**Objectif :** Créer une fonction rapide.

✅ **Solution** :
```bash
editconfigs() {
    nano ~/.bashrc ~/.profile ~/.vimrc
}
```

💡 **Utilisation** :
```bash
editconfigs
```

---

### **Exercice 8 – Créer et entrer dans un dossier**
**Problème :** Tu veux créer un dossier et t’y déplacer d’un coup.  
**Objectif :** Fonction avec argument.

✅ **Solution** :
```bash
mdcd() {
    mkdir -p "$1" && cd "$1"
}
```

💡 **Utilisation** :
```bash
mdcd mon_dossier
```

---

### **Exercice 9 – Initialiser un projet rapidement**
**Problème :** Tu veux automatiser la création d’un projet git.  
**Objectif :** Routine de setup.

✅ **Solution** :
```bash
init_projet() {
    mkdir "$1" && cd "$1" && git init && touch README.md
}
```

💡 **Utilisation** :
```bash
init_projet nom_du_projet
```

---

### **Exercice 10 – Afficher la date à chaque ouverture de terminal**
**Problème :** Tu veux voir la date à chaque session.  
**Objectif :** Message de bienvenue.

✅ **Solution** :
```bash
echo "Nous sommes le $(date '+%A %d %B %Y')"
```

💡 **Utilisation** : automatique à chaque ouverture du terminal.

---

## 🔹 Niveau 3 – Variables d’environnement (Ex. 11 à 15)

---

### **Exercice 11 – Définir une variable simple**
**Problème :** Tu veux utiliser ton prénom dans tes scripts.  
**Objectif :** Créer une variable d’environnement.

✅ **Solution** :
```bash
export PRENOM="Amine"
```

💡 **Utilisation** :
```bash
echo "Bonjour $PRENOM"
```

---

### **Exercice 12 – Variable utilisée dans une fonction**
**Problème :** Tu veux une salutation personnalisée.  
**Objectif :** Réutiliser une variable dans une fonction.

✅ **Solution** :
```bash
saluer() {
    echo "Salut $PRENOM !"
}
```

💡 **Utilisation** :
```bash
saluer
```

---

### **Exercice 13 – Ajouter un dossier à ton PATH**
**Problème :** Tu veux pouvoir exécuter tes scripts depuis n’importe où.  
**Objectif :** Étendre la variable PATH.

✅ **Solution** :
```bash
export PATH="$PATH:$HOME/scripts"
```

💡 **Utilisation** : après avoir mis des scripts exécutables dans `~/scripts`, tu peux simplement faire :
```bash
mon_script
```

---

### **Exercice 14 – Stocker la date dans une variable**
**Problème :** Tu veux une variable `TODAY` avec la date.  
**Objectif :** Créer une variable dynamique.

✅ **Solution** :
```bash
export TODAY=$(date +%F)
```

💡 **Utilisation** :
```bash
echo "Aujourd’hui : $TODAY"
```

---

### **Exercice 15 – Variable temporaire de session**
**Problème :** Tu veux tester un environnement temporaire.  
**Objectif :** Créer une variable pour une session uniquement.

✅ **Solution** :
```bash
export ENVIRONNEMENT="test"
```

💡 **Utilisation** :
```bash
echo $ENVIRONNEMENT
```

---

## 🔸 Niveau 4 – Personnalisation de session (Ex. 16 à 20)

---

### **Exercice 16 – Modifier le prompt du terminal**
**Problème :** Tu veux que l’heure s’affiche dans ton prompt.  
**Objectif :** Modifier `PS1`.

✅ **Solution** :
```bash
export PS1="\t \u@\h:\w\$ "
```

💡 **Utilisation** : le prompt changera dès la recharge du `.bashrc`.

---

### **Exercice 17 – Message de bienvenue personnalisé**
**Problème :** Tu veux un message sympa à chaque session.  
**Objectif :** Ajouter une ligne dans `.bashrc`.

✅ **Solution** :
```bash
echo "Bienvenue $USER, bon travail !"
```

💡 **Utilisation** : s’exécute automatiquement à chaque ouverture de terminal.

---

### **Exercice 18 – Exécuter une commande à la connexion**
**Problème :** Tu veux lancer `neofetch` automatiquement.  
**Objectif :** Lancer un programme à la connexion.

✅ **Solution** (dans `.profile` ou `.bash_profile`) :
```bash
if command -v neofetch &> /dev/null; then
    neofetch
fi
```

💡 **Utilisation** : affichage automatique des infos système au login.

---

### **Exercice 19 – Changer les couleurs du terminal**
**Problème :** Tu veux que le texte du prompt soit en vert.  
**Objectif :** Personnalisation visuelle.

✅ **Solution** :
```bash
export PS1="\[\e[32m\]\u@\h:\w\$ \[\e[m\]"
```

💡 **Utilisation** : couleur appliquée dès la recharge du `.bashrc`.

---

### **Exercice 20 – Lancer automatiquement un environnement de dev**
**Problème :** Tu veux automatiser la configuration d’un projet Python.  
**Objectif :** Routine d’ouverture de session DevOps.

✅ **Solution** :
```bash
dev_env() {
    cd ~/projets/mon_projet && source venv/bin/activate && code .
}
```

💡 **Utilisation** :
```bash
dev_env
```

---

Souhaites-tu que je te génère un PDF ou un fichier `.md` prêt à distribuer pour ton bootcamp ?
