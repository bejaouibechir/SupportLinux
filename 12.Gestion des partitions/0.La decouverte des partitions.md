Parfait ğŸ‘Œ  
Voici la **Phase 3 â€“ Version 2 amÃ©liorÃ©e** de ton **Atelier 1 : DÃ©couverte du disque et de ses partitions**, intÃ©grant **tous les points issus de la critique analytique**.  
Cette version est prÃªte Ã  Ãªtre testÃ©e et validÃ©e comme version finale de rÃ©fÃ©rence.

---

# ğŸ§° Atelier 1 â€“ DÃ©couverte du disque et de ses partitions *(Version 2 amÃ©liorÃ©e)*

### ğŸ”– Informations gÃ©nÃ©rales

- **DurÃ©e estimÃ©e** : 40 Ã  50 minutes

- **Niveau** : dÃ©butant Ã  intermÃ©diaire

- **Objectif global** : comprendre la structure et la composition des disques sous Linux Debian, identifier les partitions, leur type, leur systÃ¨me de fichiers et leur point de montage.

- **PrÃ©requis** : machine Debian 12/13 avec droits `sudo` et, si possible, un second disque virtuel (`sdb` dâ€™environ 2 Go).

---

## 1ï¸âƒ£ Contexte et objectif

Un administrateur systÃ¨me vient de recevoir une machine Debian fraÃ®chement installÃ©e.  
Avant de configurer des services ou dâ€™ajouter de nouveaux volumes, il doit **dresser un inventaire complet du stockage** : disques, partitions, systÃ¨mes de fichiers et points de montage.

> ğŸ¯ Ã€ la fin de lâ€™atelier, vous saurez :
> 
> - Identifier les disques visibles par le systÃ¨me.
> 
> - Lire une table de partitions (MBR/GPT).
> 
> - Associer chaque partition Ã  son systÃ¨me de fichiers et point de montage.
> 
> - Produire un inventaire synthÃ©tique exportable.

---

## 2ï¸âƒ£ PrÃ©paration de lâ€™environnement

### Ã‰tape 1 : VÃ©rifier la prÃ©sence des disques

```bash
sudo ls /dev/sd*
```

- Si vous voyez `/dev/sda` et `/dev/sdb`, câ€™est parfait.

- Si vous Ãªtes dans un environnement cloud, les noms peuvent Ãªtre diffÃ©rents :
  
  - `/dev/vda` (VirtIO)
  
  - `/dev/nvme0n1` (disque NVMe)

### Ã‰tape 2 : Nettoyer les montages rÃ©siduels

```bash
sudo umount -a 2>/dev/null || true
```

> ğŸ’¡ **Astuce :** Si vous venez dâ€™ajouter un disque virtuel dans VirtualBox, exÃ©cutez :
> 
> ```bash
> sudo partprobe
> ```
> 
> pour que le noyau prenne en compte le nouveau disque sans redÃ©marrage.

---

## 3ï¸âƒ£ Ã‰tapes pas Ã  pas

### ğŸ”¹ Ã‰tape 1 â€“ Inspection du disque principal

```bash
lsblk
```

**RÃ©sultat attendu typique :**

```
NAME   MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTS
sda      8:0    0   20G  0 disk 
â”œâ”€sda1   8:1    0   19G  0 part /
â””â”€sda2   8:2    0    1G  0 part [SWAP]
sdb      8:16   0    2G  0 disk
```

**InterprÃ©tation :**

- `TYPE=disk` â†’ disque physique complet

- `TYPE=part` â†’ partition

- `MOUNTPOINTS` indique oÃ¹ elle est montÃ©e

> ğŸ§  **Remarque :** les noms changent selon le type de disque (`sda`, `vda`, `nvme0n1`), mais la logique reste identique.

---

### ğŸ”¹ Ã‰tape 2 â€“ Lecture de la table de partition

```bash
sudo fdisk -l
```

**Exemple :**

```
Disk /dev/sda: 20 GiB, 21474836480 bytes, 41943040 sectors
Disklabel type: gpt
Device       Start      End  Sectors  Size Type
/dev/sda1     2048 39843839 39841792   19G Linux filesystem
/dev/sda2  39843840 41940991  2097152    1G Linux swap
```

**Analyse :**

- `Disklabel type` â†’ GPT

- `Start/End/Sectors` â†’ positions physiques

- `Type` â†’ type de partition

---

### ğŸ”¹ Ã‰tape 3 â€“ VÃ©rification via parted

```bash
sudo parted -l
```

**Extrait attendu :**

```
Model: ATA VBOX HARDDISK (scsi)
Disk /dev/sda: 21.5GB
Partition Table: gpt
Number  Start   End     Size    File system  Name  Flags
 1      1049kB  20.4GB  20.4GB  ext4
 2      20.4GB  21.5GB  1074MB  linux-swap
```

**IntÃ©rÃªt :**  
`parted` gÃ¨re mieux les disques GPT et affiche la table sous un format plus lisible.

---

### ğŸ”¹ Ã‰tape 4 â€“ Identifier les systÃ¨mes de fichiers

```bash
sudo blkid
```

**Exemple :**

```
/dev/sda1: UUID="32a7...bcd" TYPE="ext4" PARTLABEL="root"
/dev/sda2: UUID="9f3e...21b" TYPE="swap"
```

> `UUID` = identifiant unique du systÃ¨me de fichiers.  
> `TYPE` = nature du FS (ext4, xfs, swap, etc.).

---

### ğŸ”¹ Ã‰tape 5 â€“ Confirmer les points de montage

```bash
df -Th
```

**Exemple :**

```
Filesystem     Type  Size  Used Avail Use% Mounted on
/dev/sda1      ext4   19G  4.0G   15G  22% /
tmpfs          tmpfs 1.9G     0  1.9G   0% /dev/shm
```

---

### ğŸ”¹ Ã‰tape 6 â€“ Lecture bas niveau du noyau

```bash
cat /proc/partitions
```

**Extrait :**

```
major minor  #blocks  name
   8        0   20971520 sda
   8        1   19920896 sda1
   8        2    1048576 sda2
```

> Cette vue brute est utile pour diagnostiquer des problÃ¨mes bas niveau ou pour les scripts systÃ¨me.

---

### ğŸ”¹ Ã‰tape 7 â€“ DÃ©tection de type brut du contenu

```bash
sudo file -s /dev/sda1
```

**Exemple :**

```
/dev/sda1: Linux rev 1.0 ext4 filesystem data, UUID=32a7bcd1..., volume name "rootfs"
```

---

### ğŸ”¹ Ã‰tape 8 â€“ RÃ©sumÃ© global et export

```bash
lsblk -f
```

**RÃ©sultat :**

```
NAME   FSTYPE LABEL UUID                                 MOUNTPOINTS
sda                                                          
â”œâ”€sda1 ext4         32a7bcd1-...                            /
â””â”€sda2 swap         9f3e21b-...                             [SWAP]
sdb
```

Exporter le rapport :

```bash
lsblk -f > /tmp/inventaire_disques.txt
cat /tmp/inventaire_disques.txt
```

---

## 4ï¸âƒ£ VÃ©rification & mini-exercice de synthÃ¨se

ğŸ‘‰ **TÃ¢che :**  
CrÃ©ez un petit tableau (papier ou Ã©diteur de texte) rÃ©capitulant vos observations :

| Nom du pÃ©riphÃ©rique | Taille | Type | SystÃ¨me de fichiers | Point de montage |
| ------------------- | ------ | ---- | ------------------- | ---------------- |
| `/dev/sda1`         | 19G    | part | ext4                | `/`              |
| `/dev/sda2`         | 1G     | part | swap                | `[SWAP]`         |
| `/dev/sdb`          | 2G     | disk | â€”                   | â€”                |

---

## 5ï¸âƒ£ Nettoyage / Rollback

Aucune dÃ©sinstallation nÃ©cessaire.  
Si vous aviez ajoutÃ© un disque virtuel `sdb` :

1. Ã‰teignez la VM.

2. Retirez le disque depuis VirtualBox ou votre console cloud.

Optionnel : supprimer le fichier dâ€™inventaire.

```bash
rm /tmp/inventaire_disques.txt
```

---

## 6ï¸âƒ£ Astuces & piÃ¨ges courants

| ProblÃ¨me                        | Cause probable                   | Solution                                         |
| ------------------------------- | -------------------------------- | ------------------------------------------------ |
| Le disque ajoutÃ© nâ€™apparaÃ®t pas | Le noyau nâ€™a pas relu la table   | `sudo partprobe`                                 |
| Les noms `/dev/sda` changent    | Ordre de dÃ©tection du contrÃ´leur | Identifier via `lsblk -S`                        |
| Pas de FS dÃ©tectÃ©               | Partition non formatÃ©e           | Ã€ traiter dans Atelier 2                         |
| UUID manquant                   | FS corrompu ou inexistant        | RecrÃ©er avec `mkfs.ext4 -U random`               |
| Affichage tronquÃ©               | Terminal trop Ã©troit             | Utiliser `lsblk -o NAME,SIZE,FSTYPE,MOUNTPOINTS` |

---

## 7ï¸âƒ£ Visualisation hiÃ©rarchique (schÃ©ma Mermaid)

```mermaid
graph TD
    A[Disque physique /dev/sda] --> B[Partition /dev/sda1]
    A --> C[Partition /dev/sda2]
    B --> D[SystÃ¨me de fichiers ext4]
    C --> E[SystÃ¨me de fichiers swap]
    D --> F[MontÃ© sur /]
    E --> G[UtilisÃ© comme mÃ©moire swap]
```

---

## 8ï¸âƒ£ Transition vers lâ€™atelier suivant

> ğŸ”œ **Atelier 2 : CrÃ©ation et formatage dâ€™une nouvelle partition**
> 
> Vous apprendrez Ã  crÃ©er une partition sur le disque `sdb`, Ã  la formater en ext4 et Ã  la monter sur `/data`.

---

Souhaitez-vous que je te prÃ©pare maintenant **Atelier 2 â€“ CrÃ©ation et formatage dâ€™une nouvelle partition** (Phase 1, version initiale complÃ¨te) dans le mÃªme format ?
