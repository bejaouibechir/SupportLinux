# ðŸ§ª **DÃ©mo pratique : Comprendre `umask`**

---

## **ðŸŽ¯ Objectif**

* Comprendre comment `umask` dÃ©termine les **droits par dÃ©faut** pour les fichiers et dossiers crÃ©Ã©s.
* VÃ©rifier que `umask` **nâ€™affecte pas les fichiers existants**.
* Voir la diffÃ©rence entre plusieurs valeurs de `umask`.

---

## **1. VÃ©rifier lâ€™umask actuelle**

```bash
umask
```

### Exemple de sortie :

```bash
0022
```

* Ici, `0022` â†’ signifie que **lâ€™Ã©criture** est interdite pour **les autres** et **les groupes** par dÃ©faut.
* Pour un affichage symbolique (plus lisible) :

```bash
umask -S
```

Exemple de sortie :

```bash
u=rwx,g=rx,o=rx
```

---

## **2. CrÃ©er un rÃ©pertoire de test**

On va travailler dans `/tmp` pour ne pas toucher aux fichiers systÃ¨me :

```bash
cd /tmp
mkdir umask_demo
cd umask_demo
```

---

## **3. Observer les droits actuels avec `umask 0022`**

```bash
umask 0022
touch fichier1
mkdir dossier1
ls -ld fichier1 dossier1
```

### **RÃ©sultat attendu**

```
-rw-r--r--  1 root root    0 Sep 10 12:10 fichier1
drwxr-xr-x  2 root root 4096 Sep 10 12:10 dossier1
```

ðŸ”¹ **Explication** :

* Les **fichiers** â†’ droits max = `666` â†’ `666 - 022 = 644` â†’ `rw-r--r--`
* Les **dossiers** â†’ droits max = `777` â†’ `777 - 022 = 755` â†’ `rwxr-xr-x`

---

## **4. Changer lâ€™umask**

On modifie lâ€™umask pour Ãªtre plus restrictive :

```bash
umask 0077
touch fichier2
mkdir dossier2
ls -ld fichier2 dossier2
```

### **RÃ©sultat attendu**

```
-rw-------  1 root root    0 Sep 10 12:12 fichier2
drwx------  2 root root 4096 Sep 10 12:12 dossier2
```

ðŸ”¹ **Explication** :

* **umask 077** â†’ retire tous les droits au groupe et aux autres.
* Fichiers : `666 - 077 = 600` â†’ `rw-------`
* Dossiers : `777 - 077 = 700` â†’ `rwx------`

---

## **5. Rendre les fichiers accessibles Ã  tous**

Changeons maintenant lâ€™umask pour donner un accÃ¨s quasi complet :

```bash
umask 0000
touch fichier3
mkdir dossier3
ls -ld fichier3 dossier3
```

### **RÃ©sultat attendu**

```
-rw-rw-rw-  1 root root    0 Sep 10 12:14 fichier3
drwxrwxrwx  2 root root 4096 Sep 10 12:14 dossier3
```

ðŸ”¹ **Explication** :

* **umask 000** â†’ ne retire aucun droit.
* Fichiers : `666 - 000 = 666` â†’ `rw-rw-rw-`
* Dossiers : `777 - 000 = 777` â†’ `rwxrwxrwx`

---

## **6. VÃ©rifier que les anciens fichiers ne changent pas**

```bash
ls -l
```

### Exemple de sortie finale :

```
-rw-r--r--  1 root root    0 Sep 10 12:10 fichier1
-rw-------  1 root root    0 Sep 10 12:12 fichier2
-rw-rw-rw-  1 root root    0 Sep 10 12:14 fichier3
drwxr-xr-x  2 root root 4096 Sep 10 12:10 dossier1
drwx------  2 root root 4096 Sep 10 12:12 dossier2
drwxrwxrwx  2 root root 4096 Sep 10 12:14 dossier3
```

ðŸ”¹ **Conclusion** : `umask` nâ€™a **aucun effet rÃ©troactif**.
Elle n'agit **que** sur les **nouveaux fichiers/dossiers** crÃ©Ã©s aprÃ¨s la modification.

---

## **7. RÃ©sumÃ© pÃ©dagogique**

| **umask** | **Fichiers crÃ©Ã©s** | **Dossiers crÃ©Ã©s** | **Utilisation typique**                |
| --------- | ------------------ | ------------------ | -------------------------------------- |
| `0000`    | `rw-rw-rw-`        | `rwxrwxrwx`        | Tout le monde peut tout faire          |
| `0002`    | `rw-rw-r--`        | `rwxrwxr-x`        | Partage entre membres d'un mÃªme groupe |
| `0022`    | `rw-r--r--`        | `rwxr-xr-x`        | RÃ©glage par dÃ©faut classique           |
| `0077`    | `rw-------`        | `rwx------`        | TrÃ¨s restrictif, privÃ©                 |

---

## **8. Rendre lâ€™umask permanente**

Pour appliquer une umask **dÃ©finitivement** :

```bash
nano ~/.bashrc
```

Ajoute par exemple :

```bash
umask 0022
```

Puis recharge la configuration :

```bash
source ~/.bashrc
```

