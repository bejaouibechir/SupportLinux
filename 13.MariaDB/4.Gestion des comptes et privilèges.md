# Atelier 2 — Gestion des comptes et privilèges avec bonnes pratiques

## But de l’atelier

**Apprendre à :**

1. Vérifier les privilèges attribués à un utilisateur (`SHOW GRANTS`).

2. Appliquer de bonnes pratiques de gestion des comptes MariaDB.

3. Modifier les droits d’un utilisateur (ajout, retrait).

4. Supprimer proprement un utilisateur.

Cet atelier illustre l’importance de savoir auditer et gérer les droits utilisateurs pour renforcer la sécurité.

---

## Étapes de l’atelier

1. Vérifier les droits de `stock_user` créés lors de l’atelier précédent.

2. Ajouter un nouveau droit (`DELETE`) et constater la différence.

3. Retirer un droit (`UPDATE`) et constater la différence.

4. Supprimer un utilisateur.

5. Présenter les bonnes pratiques de gestion des comptes.

---

## Démarches (commandes commentées)

### 1. Vérifier les privilèges d’un utilisateur

```sql
-- Affiche les privilèges actuellement attribués à l'utilisateur stock_user
SHOW GRANTS FOR 'stock_user'@'localhost';
```

Résultat attendu (après l’atelier 1) :

```
GRANT SELECT, INSERT, UPDATE ON `gestion_stock`.* TO `stock_user`@`localhost`
```

---

### 2. Ajouter un droit

```sql
-- Ajout du droit DELETE sur la base gestion_stock
GRANT DELETE ON gestion_stock.* TO 'stock_user'@'localhost';
FLUSH PRIVILEGES;

-- Vérification des privilèges
SHOW GRANTS FOR 'stock_user'@'localhost';
```

Résultat attendu : la commande `DELETE` apparaît dans la liste des droits.

---

### 3. Retirer un droit

```sql
-- Retrait du droit UPDATE
REVOKE UPDATE ON gestion_stock.* FROM 'stock_user'@'localhost';
FLUSH PRIVILEGES;

-- Vérification des privilèges
SHOW GRANTS FOR 'stock_user'@'localhost';
```

Résultat attendu : la commande `UPDATE` a disparu de la liste.

---

### 4. Supprimer un utilisateur

```sql
-- Suppression complète de l'utilisateur stock_user
DROP USER 'stock_user'@'localhost';
```

Résultat attendu :

```
Query OK, 0 rows affected
```

Vérification que le compte n’existe plus :

```sql
SELECT User, Host FROM mysql.user;
```

Le compte `stock_user` ne doit plus apparaître.

---

### 5. Bonnes pratiques (explications)

- Utiliser un mot de passe fort (long, aléatoire, avec caractères spéciaux).

- Donner uniquement les droits nécessaires (principe du moindre privilège).

- Vérifier régulièrement les privilèges avec `SHOW GRANTS`.

- Ne pas utiliser le compte root pour les applications.

- Limiter les hôtes autorisés : privilégier `'user'@'localhost'` plutôt que `'user'@'%'`.

- Supprimer les comptes inutilisés pour réduire la surface d’attaque.

---

## Résultats attendus

- Être capable de lister les privilèges d’un compte avec `SHOW GRANTS`.

- Savoir ajouter et retirer des privilèges avec `GRANT` et `REVOKE`.

- Savoir supprimer un utilisateur avec `DROP USER`.

- Comprendre les bonnes pratiques de gestion des comptes MariaDB.

-
